# MaleLimitedEvo Transcriptomics Analysis

## Overview
This project involves the bioinformatic processing of RNA-Seq data from FastQ files to .tsv files, which are ready for downstream analysis in the R package DESeq2 (not shown here). It is divided into two main scripts: `Get_Reference_Genome.sh` and `MaleLimitedEvo_Pipeline.sh`.

## Scripts

### 1. Get_Reference_Genome.sh
This script is responsible for acquiring and indexing the reference genome files required for the RNA-Seq analysis.

#### Functionality
- Downloads the reference genome FASTA file and GTF file from Ensembl.
- Unzips the downloaded files.
- Indexes the reference genome using BWA and samtools.
- Generates genome indices using STAR.

#### Input Files
- None (the script downloads the necessary files).

#### Output Files
- `Drosophila_melanogaster.BDGP6.28.dna.toplevel.fa` (reference genome FASTA file)
- `Drosophila_melanogaster.BDGP6.28.102.gtf` (GTF file)
- BWA index files: `Drosophila_melanogaster.BDGP6.28.dna.toplevel.fa.bwt`, `.pac`, `.ann`, `.amb`, `.sa`
- Samtools index file: `Drosophila_melanogaster.BDGP6.28.dna.toplevel.fa.fai`
- STAR genome indices in the `STAR` directory

### 2. MaleLimitedEvo_Pipeline.sh
*Disclaimer: This script has not been tested yet. It may or may not work as expected.*

This script processes RNA-Seq data from FastQ files to .tsv files using the indexed reference genome generated by `Get_Reference_Genome.sh`.

#### Functionality
- Maps RNA-Seq reads to the reference genome using STAR.
- Generates unmapped BAM files and merges them with aligned BAM files using GATK.
- Marks duplicates in the BAM files.
- Sorts the BAM files.
- Runs HTSeq count to generate .tsv files for downstream analysis.

#### Input Files
- Paired-end FastQ files located in the `FASTQ_DIR` directory.
- Indexed reference genome files generated by `Get_Reference_Genome.sh`.

#### Output Files
- `Aligned.out.bam` (STAR mapping output)
- `*_dpl.txt` (MarkDuplicates metrics file)
- `*_sorted.bam` (final sorted BAM file)
- `*.tsv` (HTSeq count output)

## Usage
1. Run `Get_Reference_Genome.sh` to download and index the reference genome files.
   ```bash
   sbatch Get_Reference_Genome.sh
   ```

2. Run `MaleLimitedEvo_Pipeline.sh` to process the RNA-Seq data.
   ```bash
   sbatch MaleLimitedEvo_Pipeline.sh
   ```

Ensure that the input directories and file paths are correctly specified in the scripts before running them.
